<!DOCTYPE html>
<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Momo+Trust+Display&display=swap" rel="stylesheet">
        <title>My pets</title>
        <style>
            body {
                background-color: aquamarine;
            }
            * {
                font-family: "Momo Trust Display", sans-serif;
                align-items: center;
            }
            .container {
                margin: auto;
                width: 80%;
                padding: 10px;
            }
            h1 {
                text-align: center;
            }
            .petsform {
                margin: 0 auto;
                width: 50%;
                padding: 10px;
                border:3px solid black;
                border-radius: 10px;
                background-color: aqua;
            }
            button {
                width: 120px;
                border-radius: 25px;
                padding: 7px;
                margin-left:10px;
                border: 4px solid black;
                background-color: darkcyan;
            }
            button:hover{
                transform: scale(1.1);
                transition: 0.2s;
            }
            button:not(hover){
                transition: 0.2s;
            }
            input {
                margin-right: 10px;
                padding: 10px;
                border-radius: 25px;
                border: none;
            }
            #pets-table {
                border-collapse: collapse;
                margin: 25px 0;
                font-size: 0.9em;
                font-family: sans-serif;
                min-width: 400px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            }

                #pets-table thead tr {
                background-color: #009879;
                color: #ffffff;
                text-align: left;
                font-weight: bold;
            }

                #pets-table th,
                #pets-table td {
                padding: 12px 15px;
                }

                #pets-table tbody tr {
                border-bottom: 1px solid #dddddd;
            }

                #pets-table tbody tr:nth-of-type(even) {
                background-color: #f3f3f3;
            }

                #pets-table tbody tr:last-of-type {
                border-bottom: 2px solid #009879;
            }   
        </style>
    </head>
    <body>
        <div class="container">
        <h1>Pets</h1>
        <form class="petsform">
            <input id="pet-name" placeholder="Pet name">
            <input id="pet-type" placeholder="Pet type">
            <input id="pet-color" placeholder="Pet color">
            <input id="pet-age" placeholder="Set age">
            <button>Add</button>
        </form>
    </div>
    </body>
    <script>
        
        
        

        document.querySelector('button').addEventListener('click', () => {
            event.preventDefault(); // Prevents page reload
            console.log("Sending to database...")

            const petName = document.getElementById('pet-name').value;
            const petType = document.getElementById('pet-type').value;
            const petColor = document.getElementById('pet-color').value;
            const petAge = document.getElementById('pet-age').value;

            fetch('http://localhost:8000/pets', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({name: petName, type: petType, color: petColor, age: petAge })
            }).then(getPets());

        });

       
        function getPets(){

            console.log("Getting from database...")
            fetch('http://localhost:8000/getpets', {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' }
            })
            .then(response => response.json())
            .then(data => {
                let table = '<table id="pets-table" border="1"><tr><th>ID</th><th>Name</th><th>Type</th><th>Color</th><th>Age</th></tr>';
                data.forEach(pet => {
                    table += `<tr><td>${pet[0]}</td><td>${pet[1]}</td><td>${pet[2]}</td><td>${pet[3]}</td><td>${pet[4]}</td></tr>`;
                });
                table += '</table>';
                document.querySelector('.container').innerHTML += table;
            });
        }
            



    </script>
</html>